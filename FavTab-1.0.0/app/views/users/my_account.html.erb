<%= javascript_include_tag 'tab' %>
<%= javascript_include_tag 'discussion' %>
<style>
  .discus_web_url_link
  {
    max-width: 610px !important;
    word-wrap: break-word;
  }
  .my_discussion_comment_link
  {
    color: #64B0CC;
    float: right;
    font-size: 12px;
    left: 10px;
    position: absolute;
    text-align: right;
    text-decoration: none;
    top: 0;
    width: 655px;
  }
</style>
<div class="left_panel" align="center">
  <%= render :partial => "user_left_panel" %>
</div>
<div class="main_panel">
  <div class="profile_tabs_container">
    <div class="profile_detail_div">
      <%= render :partial=>"user_account" %>
    </div>
    <div class="tabs_div">
      <%= render :partial=>"tab_section" %>
    </div>
  </div>
  
  <!-- Discussion section starts -->
  <% unless @login_user.is_admin? and @other_user==@login_user %>
    <div class="profile_discussion_block" id="discuss_a_web_page_div">
      <div class="discussion_header" align="left">
        <span class="blue_header padding_left_ten" id="my_discussion_header"><%= @is_current_user ? "My" : truncate(@other_user.username, :length=>20)+"'s" %> Discussions</span>
        <% if @other_user and @other_user==current_user%>
          <div class="profile_post_url_div" align="right">
            <%= form_for :discussion, :url=>{:controller=>:discussions, :action => 'create_discussion'}, :remote=>true do |f|  %>
              <table width="96%" class="post_url_form">
                <tr>
                  <td  align="left" width="30%"><span class="form_field_name">URL:<span class="mendatory">*</span></span></td>
                  <td align="left" ><%= text_field 'discussion', 'url', :class=>"discuss_url_text_box"%><br/><span id="urlError" class="form_error"></span></td>
                </tr>
                <tr>
                  <td></td>
                  <td align="right">
                    <input type="submit" class="blue_btn" value="Discuss" onclick="return check_url()"/>
                  </td>
                </tr>
              </table>
            <%end%>
          </div>
        <% end %>
      </div>
      <div id="my_discussion_comments">
        <%= render :partial => "discussions/my_discussions", :locals=>{:discussions=>@discussions,:direct=>true}, :layout => false %>
      </div>
    </div>
  <% end %>
  <!-- Discussion section ends -->
  
</div>


<script type="text/javascript">
  <% @other_user.nil? ? @other_user=@login_user :@other_user %>
  function load_my_comments()
  {
    jQuery.get('/load_my_comments/<%= @other_user.id  %> ', function(data) {
      jQuery("#my_discussion_comments").html(data);
      jQuery("#my_discussion_header").html("<%= @is_current_user ? "My" : truncate(@other_user.username, :length=>20)+"'s" %> Comments");
      jQuery(".my_discussion_comment_link").html("<%= @is_current_user ? "My" : truncate(@other_user.username, :length=>20)+"'s" %> Discussions");
    });
  }
   function load_my_discussions()
  {
    jQuery.get('/load_my_discussions/<%= @other_user.id  %>', function(data) {
      jQuery("#my_discussion_comments").html(data);
      jQuery("#my_discussion_header").html("<%= @is_current_user ? "My" : truncate(@other_user.username, :length=>20)+"'s" %> Discussions");
      jQuery(".my_discussion_comment_link").html("<%= @is_current_user ? "My" : truncate(@other_user.username, :length=>20)+"'s" %> Comments");
    });
  }
  jQuery(document).ready(function(){
    jQuery(".my_discussion_comment_link").html("<%= @is_current_user ? "My" : truncate(@other_user.username, :length=>20)+"'s" %> Comments");
    apply_scroll_effects();
    
  });
</script>